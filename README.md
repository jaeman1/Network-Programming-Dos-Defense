# 실시간 DoS 공격 탐지 및 자동 방어 시스템

## 📖 프로젝트 개요

네트워크 트래픽을 실시간으로 감시하여 **DoS(Denial of Service) 공격을 탐지하고, 공격자의 IP를 동적으로 차단**하는 Python 기반의 경량 방어 프로그램입니다. `Scapy`를 이용한 패킷 분석과 `iptables`를 활용한 자동 방어 규칙 생성을 통해 시스템을 보호합니다.

---

## 🚀 주요 기능

- **실시간 패킷 모니터링**: `Scapy` 라이브러리를 사용하여 지정된 네트워크 인터페이스의 모든 IP 패킷을 실시간으로 캡처하고 분석합니다.
- **임계값 기반 공격 탐지**: 외부 설정 파일(`config.json`)에 정의된 초당 패킷 수(PPS) 임계값을 초과하는 트래픽이 발생할 경우 DoS 공격으로 판단합니다.
- **동적 IP 차단**: 공격으로 판단된 트래픽의 출발지 IP를 식별하고, `subprocess` 모듈을 통해 `iptables` 방화벽에 해당 IP를 차단하는 규칙을 자동으로 추가합니다.
- **일시적 차단 및 자동 해제 (Temporary Ban)**:
  - 오탐으로 인한 정상 사용자의 영구적인 서비스 차단을 방지하기 위해, 공격 IP를 설정된 시간(기본 5분) 동안만 차단합니다.
  - 별도의 스레드가 주기적으로 차단 목록을 관리하며, 차단 시간이 만료된 IP는 `iptables` 규칙에서 자동으로 삭제하여 접근을 허용합니다.
- **유연한 설정 관리**: 탐지 임계값, 차단 시간 등 주요 파라미터를 `config.json` 파일로 분리하여 코드 수정 없이 유연하게 설정을 변경할 수 있습니다.

---

## 🛠️ 기술 스택

- **주요 언어**: `Python`
- **라이브러리**: `Scapy`, `subprocess`, `threading`, `json`
- **방화벽**: `Linux iptables`
- **개발 환경**: `Kali Linux (공격자)`, `VMware (피해자)`

---

## 🏁 실행 방법

### 사전 준비
- Python 3 및 `scapy` 라이브러리 설치 (`pip install scapy`)
- `iptables` 명령어를 사용하기 위해 root 권한 필요

### 실행
1.  `config.json` 파일에서 `threshold`(임계값), `block_duration_minutes`(차단 시간)를 원하는 값으로 설정합니다.
2.  아래 명령어를 통해 프로그램을 root 권한으로 실행합니다.
    ```bash
    sudo python dos_detectProtect.py
    ```
3.  프로그램이 실행되면 패킷 감시를 시작하며, 공격 탐지 및 차단 내역은 콘솔과 `dos_detection.log` 파일에 기록됩니다.
